services:
  anki:
    image: thisisnttheway/headless-anki:latest
    container_name: anki-headless
    environment:
      QT_QPA_PLATFORM: vnc
      ANKICONNECT_WILDCARD_ORIGIN: "1"
    volumes:
      - anki-data:/data
    ports:
      - "8765:8765"
      - "5900:5900"  # VNC â€” for AnkiWeb login and debugging
    restart: unless-stopped
    mem_limit: 512m

  portal:
    build: .
    # Or use the pre-built image from Docker Hub instead of building locally:
    # image: gykpro/anki-spelling-portal:latest
    container_name: spelling-portal
    environment:
      ANKI_CONNECT_URL: http://anki:8765
    volumes:
      - portal-data:/app/data
    ports:
      - "3000:3000"
    depends_on:
      - anki
    restart: unless-stopped

volumes:
  anki-data:
  portal-data:
